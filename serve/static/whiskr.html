<!DOCTYPE html>
<meta charset="utf-8" />
<link rel="stylesheet" href="/style.css" />
<script type="module" src="/xyt.js"></script>
<h1>whiskr</h1>
<div
	x-app
	x-data="fetch('api/list').then(r => r.json()).then(facts => ({ facts, subject: '' }))"
>
	<details>
		<summary>all facts</summary>
		<table>
			<thead>
				<tr>
					<th>subject</th>
					<th>predicate</th>
					<th>object</th>
					<th></th>
				</tr>
			</thead>
			<tbody>
				<tr x-for="facts">
					<td x-text="subject"></td>
					<td x-text="predicate"></td>
					<td x-text="object"></td>
					<td>
						<!-- x-on:click="
						fetch('api/delete', { method: 'POST', body: JSON.stringify($data), headers: { 'Content-Type': 'application/json' } })
							.then(res => res.ok /* && $el[$.parent][$.data].facts.splice($el[$.parent][$.data].facts.indexOf($data), 1) */)
					" -->
						<button
							class="icon-button"
							x-on:click="facts.splice(facts.indexOf($data), 1)"
						>
							üóëÔ∏è
						</button>
					</td>
				</tr>
				<tr x-data="{ subject: '', predicate: '', object: '' }">
					<td><input x-model="subject" /></td>
					<td><input x-model="predicate" /></td>
					<td><input x-model="object" /></td>
					<!-- x-on:click="
					fetch('api/add', { method: 'POST', body: JSON.stringify($data), headers: { 'Content-Type': 'application/json' } })
						.then(res => res.ok /* && $el[$.parent][$.data].facts.push($data) */ && (subject = '', predicate = '', object = ''))
				" -->
					<td>
						<button
							class="icon-button"
							x-on:click="facts.push($data), subject = '', predicate = '', object = ''"
						>
							+
						</button>
					</td>
				</tr>
			</tbody>
		</table>
	</details>
	<div>
		<input placeholder="subject to edit" x-model="subject" />
		<table
			x-data="{ properties: console.log(facts.filter(fact => fact.subject === subject)) || facts.filter(fact => fact.subject === subject) }"
		>
			<thead>
				<th>predicate</th>
				<th>object</th>
			</thead>
			<tbody>
				<tr x-for="console.log('props', properties), properties">
					<!-- x-effect="TODO: delete old value, add new value. to do this we need a way to get the old value??" -->
					<td><input x-model="predicate" /></td>
					<td><input x-model="object" /></td>
				</tr>
				<tr x-data="{ predicate: '', object: '' }">
					<td><input x-model="predicate" /></td>
					<td><input x-model="object" /></td>
					<!-- x-on:click="
					fetch('api/add', { method: 'POST', body: JSON.stringify($data), headers: { 'Content-Type': 'application/json' } })
						.then(res => res.ok /* && $el[$.parent][$.data].facts.push($data) */ && (subject = '', predicate = '', object = ''))
				" -->
					<td>
						<button
							class="icon-button"
							x-on:click="facts.push({ subject, predicate, object }), predicate = '', object = ''"
						>
							+
						</button>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>
